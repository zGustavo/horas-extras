<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script
      src="https://kit.fontawesome.com/cddaf0c0ff.js"
      crossorigin="anonymous"
    ></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,300;0,700;1,700&family=Open+Sans:ital,wght@0,400;0,700;1,300;1,700&family=Poppins:wght@200;300;400;500;600;700&family=Roboto+Flex:opsz,wght@8..144,300;8..144,500;8..144,700;8..144,900&family=Roboto:wght@300;500;700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-u1OknCvxWvY5kfmNBILK2hRnQC3Pr17a+RTT6rIHI7NnikvbZlHgTPOOmMi466C8"
      crossorigin="anonymous"
    ></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.9.1/font/bootstrap-icons.css"
    />
    <link rel="stylesheet" href="/css/layout.css" />
    <link rel="stylesheet" href="/css/solicitacoes.css" />
    <title>SOLICITAÇÕES | Pref. de Salto</title>
  </head>
  <body class="bg-light">
    <div class="container-fluid">
      <%- include('../../layout/header') %>
      <div class="row mb-3">
        <div class="col-lg-2 col-sm-0" id="menu-col">
          <%- include('../../layout/navbar') %>
        </div>
        <div
          class="col-lg-10 d-flex align-items-center justify-content-center p-3 flex-column"
          id="content"
        >
        <% if (user.level === 3) { %>
            <% if(data){ %>
                <% for( let s = 0; s < data.length; s++ ) { %>
                    <div class="mt-2 w-100 border p-3 mb-4 d-flex flex-column" data-setor-nome="<%= data[s].nomeSubSetor %>">
                        <div class="wrapp d-flex align-items-center justify-content-between">
                            <div class="fs-5 fw-bold d-flex align-items-center justify-content-start tittle-expand">
                                <%= data[s].nomeSubSetor %> 
                            </div>
                            <div class="d-flex align-items-center justify-content-center button-expand" >
                                <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-arrow-down-circle-fill" viewBox="0 0 16 16">
                                    <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8.5 4.5a.5.5 0 0 0-1 0v5.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V4.5z"/>
                                </svg>                                                                    
                            </div>
                        </div>
                    </div>
                    <% if (data[s].Funcionarios) { %>
                     <% for( let j = 0; j < data[s].Funcionarios.length; j++ ) { %>
                        <div class="row w-100 d-none" style="border-left: 3px solid #8a40b4" data-func-set-nome="<%= data[s].nomeSubSetor %>">
                            <div class="fw-bold mb-4" style="color: #8a40b4;">
                                <%= data[s].Funcionarios[j].nome %> 
                            </div>
                            <% for( let a = 0; a < data[s].Funcionarios[j].Horas.length; a++ ) { %>
                                <div class="col-sm-12 col-lg-12 mb-3" data-id="<%= data[s].Funcionarios[j].Horas[a].id %>" data-all-set="<%= data[s].nomeSubSetor %>">
                                  <div class="row w-100 mb-3">
                                    <div class="col-sm-12 col-lg-8 d-flex align-items-center justify-content-center">
                                      <div class="border-bottom" id="wrapper">
                                        <div>
                                          <p class="fw-bold text-start text-dark">DATA SOLICITAÇÃO:</p>
                                          <p><%= `${new Date(data[s].Funcionarios[j].Horas[a].dataDoPedido).toLocaleDateString()}` %></p>
                                        </div>
                                        <div>
                                          <p class="fw-bold text-start text-dark">DIA SOLICITADO:</p>
                                          <p><%= `${new Date(data[s].Funcionarios[j].Horas[a].diaSolicitado).toLocaleDateString()}` %></p>
                                        </div>
                                        <div>
                                          <p class="fw-bold text-start text-dark">ENTRADA:</p>
                                          <p><%= data[s].Funcionarios[j].Horas[a].horarioEntrada %> hora(s)</p>
                                        </div>
                                        <div>
                                          <p class="fw-bold text-start text-dark">SAÍDA:</p>
                                          <p><%= data[s].Funcionarios[j].Horas[a].horarioSaida %> hora(s)</p>
                                        </div>
                                        <div>
                                          <p class="fw-bold text-start text-dark">VALOR DE HORAS:</p>
                                          <p><%= data[s].Funcionarios[j].Horas[a].totalDeHorasPedido %> hora(s)</p>
                                        </div>
                                        <div>
                                          <p class="fw-bold text-start text-dark">JUSTIFICATIVA:</p>
                                          <p><%= data[s].Funcionarios[j].Horas[a].justificativa %></p>
                                        </div>
                                        <div>
                                          <p class="fw-bold text-start text-dark">STATUS:</p>
                                          <p>
                                            <% if (data[s].Funcionarios[j].Horas[a].status === 0) { %>
                                             <strong class="text-danger">
                                              NEGADO
                                             </strong>
                                            <% } %>
                                            <% if (data[s].Funcionarios[j].Horas[a].status === 1 || data[s].Funcionarios[j].Horas[a].status === 2 || data[s].Funcionarios[j].Horas[a].status === 3) { %>
                                             <strong class="text-primary">
                                              PENDENTE
                                             </strong>
                                            <% } %>
                                            <% if (data[s].Funcionarios[j].Horas[a].status === 4) { %>
                                             <strong class="text-success">
                                              APROVADO
                                             </strong>
                                            <% } %>
                                          </p>
                                        </div>
                                      </div>
                                    </div>
                                    <div class="col-sm-12 col-lg-4 d-flex align-items-center justify-content-center">
                                      <button class="btn btn-success p-2 m-2" data-aprov-id="<%= data[s].Funcionarios[j].Horas[a].id %>">APROVAR</button>
                                      <button class="btn btn-danger p-2" data-reprov-id="<%= data[s].Funcionarios[j].Horas[a].id %>">REPROVAR</button>
                                    </div>
                                  </div> 
                                </div>
                                <% } %>                              
                        </div>
                    <% } %>
                    <% } %>
                    <div class="w-100 d-none" data-aprov-all-set-name="<%= data[s].nomeSubSetor %>">
                      <div class="d-flex align-items-center justify-content-center">
                        <button class="btn btn-success p-3 m-2" id="aprov-all">
                          APROVAR TUDO
                        </button>
                        <button class="btn btn-danger p-3 m-2" id="reprov-all">
                          REPROVAR TUDO
                        </button>
                      </div>
                    </div>
                <% } %>
                <% } else{ %>  
                  <div class="mt-2 d-flex align-items-center justify-content-center flex-column">
                      <div class="img-header mb-3">
                          <img src="/assets/img/undraw_joyride_re_968t.svg" alt="yaaay" class="img-fluid">
                      </div>
                      <div class="mb-3  d-flex align-items-center justify-content-center fs-3 fw-bold text-dark">
                          NENHUMA SOLICITAÇÃO!
                      </div>
                  </div>
               <% } %>
        <% } %>
        <% if (user.level === 1 || user.level === 2) { %>
            <% if(data.length){ %>
                <% for( let s = 0; s < data.length; s++ ) { %>
                    <div class="mt-2 w-100 border p-3 mb-4 d-flex flex-column" data-setor-nome="<%= data[s].nomeSubSetor %>">
                        <div class="wrapp d-flex align-items-center justify-content-between">
                            <div class="fs-5 fw-bold d-flex align-items-center justify-content-start tittle-expand">
                                <%= data[s].nomeSubSetor %> 
                            </div>
                            <div class="d-flex align-items-center justify-content-center button-expand" >
                                <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-arrow-down-circle-fill" viewBox="0 0 16 16">
                                    <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8.5 4.5a.5.5 0 0 0-1 0v5.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V4.5z"/>
                                </svg>                                                                    
                            </div>
                        </div>
                    </div>
                    <% for( let j = 0; j < data[s].Funcionarios.length; j++ ) { %>
                        <div class="row w-100 d-none" style="border-left: 3px solid #8a40b4" data-func-set-nome="<%= data[s].nomeSubSetor %>">
                            <div class="fw-bold mb-4" style="color: #8a40b4;">
                                <%= data[s].Funcionarios[j].nome %> 
                            </div>
                            <% for( let a = 0; a < data[s].Funcionarios[j].Horas.length; a++ ) { %>
                                <div class="col-sm-12 col-lg-12 mb-3" data-id="<%= data[s].Funcionarios[j].Horas[a].id %>">
                                  <div class="row w-100 mb-3">
                                    <div class="col-sm-12 col-lg-8 d-flex align-items-center justify-content-center">
                                      <div class="border-bottom" id="wrapper">
                                        <div>
                                          <p class="fw-bold text-start text-dark">DATA SOLICITAÇÃO:</p>
                                          <p><%= `${new Date(data[s].Funcionarios[j].Horas[a].dataDoPedido).toLocaleDateString()}` %></p>
                                        </div>
                                        <div>
                                          <p class="fw-bold text-start text-dark">DIA SOLICITADO:</p>
                                          <p><%= `${new Date(data[s].Funcionarios[j].Horas[a].diaSolicitado).toLocaleDateString()}` %></p>
                                        </div>
                                        <div>
                                          <p class="fw-bold text-start text-dark">ENTRADA:</p>
                                          <p><%= data[s].Funcionarios[j].Horas[a].horarioEntrada %> hora(s)</p>
                                        </div>
                                        <div>
                                          <p class="fw-bold text-start text-dark">SAÍDA:</p>
                                          <p><%= data[s].Funcionarios[j].Horas[a].horarioSaida %> hora(s)</p>
                                        </div>
                                        <div>
                                          <p class="fw-bold text-start text-dark">VALOR DE HORAS:</p>
                                          <p><%= data[s].Funcionarios[j].Horas[a].totalDeHorasPedido %> hora(s)</p>
                                        </div>
                                        <div>
                                          <p class="fw-bold text-start text-dark">JUSTIFICATIVA:</p>
                                          <p><%= data[s].Funcionarios[j].Horas[a].justificativa %></p>
                                        </div>
                                        <div>
                                          <p class="fw-bold text-start text-dark">STATUS:</p>
                                          <p>
                                            <% if (data[s].Funcionarios[j].Horas[a].status === 0) { %>
                                             <strong class="text-danger">
                                              NEGADO
                                             </strong>
                                            <% } %>
                                            <% if (data[s].Funcionarios[j].Horas[a].status === 1 || data[s].Funcionarios[j].Horas[a].status === 2 || data[s].Funcionarios[j].Horas[a].status === 3) { %>
                                             <strong class="text-primary">
                                              PENDENTE
                                             </strong>
                                            <% } %>
                                            <% if (data[s].Funcionarios[j].Horas[a].status === 4) { %>
                                             <strong class="text-success">
                                              APROVADO
                                             </strong>
                                            <% } %>
                                          </p>
                                        </div>
                                      </div>
                                    </div>
                                    <div class="col-sm-12 col-lg-4 d-flex align-items-center justify-content-center">
                                      <button class="btn btn-success p-2 m-2" data-aprov-id="<%= data[s].Funcionarios[j].Horas[a].id %>">APROVAR</button>
                                      <button class="btn btn-danger p-2" data-reprov-id="<%= data[s].Funcionarios[j].Horas[a].id %>">REPROVAR</button>
                                    </div>
                                  </div> 
                                </div>
                                <% } %>                              
                        </div>
                    <% } %>
                    <div class="w-100 d-none" data-aprov-all-set-name="<%= data[s].nomeSubSetor %>">
                      <div class="d-flex align-items-center justify-content-center">
                        <button class="btn btn-success p-3 m-2" id="aprov-all">
                          APROVAR TUDO
                        </button>
                        <button class="btn btn-danger p-3 m-2" id="reprov-all">
                          REPROVAR TUDO
                        </button>
                      </div>
                    </div>
                <% } %>
              <% } else{ %>  
                <div class="mt-2 d-flex align-items-center justify-content-center flex-column">
                    <div class="img-header mb-3">
                        <img src="/assets/img/undraw_joyride_re_968t.svg" alt="yaaay" class="img-fluid">
                    </div>
                    <div class="mb-3  d-flex align-items-center justify-content-center fs-3 fw-bold text-dark">
                        NENHUMA SOLICITAÇÃO!
                    </div>
                </div>
             <% } %>
        <% } %>
        <% if (user.level === 0) { %>
            <% if(data.length){ %>
                <% for( let s = 0; s < data.length; s++ ) { %>
                    <div class="mt-2 w-100 border p-3 mb-4 d-flex flex-column" data-setor-nome="<%= data[s].nome %>">
                        <div class="wrapp d-flex align-items-center justify-content-between">
                            <div class="fs-5 fw-bold d-flex align-items-center justify-content-start tittle-expand">
                                <%= data[s].nome %> 
                            </div>
                            <div class="d-flex align-items-center justify-content-center button-expand" >
                                <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-arrow-down-circle-fill" viewBox="0 0 16 16">
                                    <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8.5 4.5a.5.5 0 0 0-1 0v5.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V4.5z"/>
                                </svg>                                                                    
                            </div>
                        </div>
                    </div>
                    <% for( let j = 0; j < data[s].Horas.length; j++ ) { %>
                        <div class="row w-100 d-none" style="border-left: 3px solid #8a40b4" data-func-set-nome="<%= data[s].nome %>">
                            <div class="fw-bold mb-4" style="color: #8a40b4;">
                                <%= data[s].nome %> 
                            </div>
                            <div class="col-sm-12 col-lg-12 mb-3" data-id="<%= data[s].Horas[j] %>">
                              <div class="row w-100 mb-3">
                                <div class="col d-flex align-items-center justify-content-center flex-column border-bottom">
                                  <div class="" id="wrapper">
                                    <div>
                                      <p class="fw-bold text-start text-dark">DATA SOLICITAÇÃO:</p>
                                      <p><%= `${new Date(data[s].Horas[j].dataDoPedido).toLocaleDateString()}` %></p>
                                    </div>
                                    <div>
                                      <p class="fw-bold text-start text-dark">DIA SOLICITADO:</p>
                                      <p><%= `${new Date(data[s].Horas[j].diaSolicitado).toLocaleDateString()}` %></p>
                                    </div>
                                    <div>
                                      <p class="fw-bold text-start text-dark">ENTRADA:</p>
                                      <p><%= data[s].Horas[j].horarioEntrada %> hora(s)</p>
                                    </div>
                                    <div>
                                      <p class="fw-bold text-start text-dark">SAÍDA:</p>
                                      <p><%= data[s].Horas[j].horarioSaida %> hora(s)</p>
                                    </div>
                                    <div>
                                      <p class="fw-bold text-start text-dark">VALOR DE HORAS:</p>
                                      <p><%= data[s].Horas[j].totalDeHorasPedido %> hora(s)</p>
                                    </div>
                                    <div class="overflow-hidden">
                                      <p class="fw-bold text-start text-dark text-break" id="justificativa">JUSTIFICATIVA:</p>
                                      <p><%= data[s].Horas[j].justificativa %></p>
                                    </div>
                                    <div>
                                      <p class="fw-bold text-start text-dark">STATUS:</p>
                                      <p>
                                        <% if (data[s].Horas[j].status === 0) { %>
                                         <strong class="text-danger">
                                          NEGADO
                                         </strong>
                                        <% } %>
                                        <% if (data[s].Horas[j].status === 1 || data[s].Horas[j].status === 2 || data[s].Horas[j].status === 3) { %>
                                         <strong class="text-primary">
                                          PENDENTE
                                         </strong>
                                        <% } %>
                                        <% if (data[s].Horas[j].status === 4) { %>
                                         <strong class="text-success">
                                          APROVADO
                                         </strong>
                                        <% } %>
                                      </p>
                                    </div>
                                  </div>
                                  <% if (data[s].Horas[j].anexoPedido) { %>
                                   <a href="<%= `/sistemas/horas-extras/hora/attachment/${data[s].Horas[j].id}` %>" target="_blank" rel="noopener noreferrer" class="mb-2 me-auto btn text-light" style="background-color: #8a40b4;">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-paperclip" viewBox="0 0 16 16">
                                      <path d="M4.5 3a2.5 2.5 0 0 1 5 0v9a1.5 1.5 0 0 1-3 0V5a.5.5 0 0 1 1 0v7a.5.5 0 0 0 1 0V3a1.5 1.5 0 1 0-3 0v9a2.5 2.5 0 0 0 5 0V5a.5.5 0 0 1 1 0v7a3.5 3.5 0 1 1-7 0V3z"/>
                                    </svg>
                                    VISUALIZAR ANEXO.
                                   </a>
                                  <% } %>
                                </div>
                              </div> 
                            </div>                            
                        </div>
                    <% } %>
                    <div class="w-100 d-none" >
                      <div class="d-flex align-items-center justify-content-center">
                        <button class="btn btn-success p-3 m-2" data-aprov-all-set-name="<%= data[s].nomeSubSetor %>">
                          APROVAR TUDO
                        </button>
                        <button class="btn btn-danger p-3 m-2" data-reprov-all-set-name="<%= data[s].nomeSubSetor %>">
                          REPROVAR TUDO
                        </button>
                      </div>
                    </div>
                <% } %>
              <% } else{ %>  
                <div class="mt-2 d-flex align-items-center justify-content-center flex-column">
                    <div class="img-header mb-3">
                        <img src="/assets/img/undraw_joyride_re_968t.svg" alt="yaaay" class="img-fluid">
                    </div>
                    <div class="mb-3  d-flex align-items-center justify-content-center fs-3 fw-bold text-dark">
                        NENHUMA SOLICITAÇÃO!
                    </div>
                </div>
             <% } %>
        <% } %>
        
      </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="/js/layout.js"></script>
    <script src="/js/solicitacoes.js"></script>
  </body>
</html>
